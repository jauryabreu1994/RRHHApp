@model RRHHApp.Models.Usuarios.Usuario

@{
    ViewBag.Title = "Editar Usuario";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


    <div class="pagetitle">
        <h1>@ViewBag.Title </h1>
    </div>

    <!-- End Page Title -->
    <section class="section">
        <div class="row">
            <div class="col-lg-10">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"> Datos Generales </h5>

                        <!-- Horizontal Form -->
                        @using (Html.BeginForm())
                        {
                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                            @Html.HiddenFor(model => model.Id)
                            @Html.HiddenFor(model => model.FechaCreacion)
                            @Html.HiddenFor(model => model.FechaModificacion)
                            @Html.HiddenFor(model => model.Estado)
                            @Html.HiddenFor(model => model.Eliminado)


                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Codigo </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.UsuarioId, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.UsuarioId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Nombre </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Nombre, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Nombre, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Apellido </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Apellido, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Apellido, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Cedula o RNC </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Identificacion, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Identificacion, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Pais </label>
                                <div class="col-sm-10">
                                    @Html.DropDownList("PaisId", null, htmlAttributes: new { @class = "form-control", autocomplete = "off" })
                                    @Html.ValidationMessageFor(model => model.PaisId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Ciudad </label>
                                <div class="col-sm-10">
                                    <select id="CiudadId" name="CiudadId" class="form-control"></select>
                                    @Html.ValidationMessageFor(model => model.CiudadId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Direccion </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Direccion, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Direccion, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Grupo de Usuario </label>
                                <div class="col-sm-10">
                                    @Html.DropDownList("GrupoUsuarioId", null, htmlAttributes: new { @class = "form-control", autocomplete = "off" })
                                    @Html.ValidationMessageFor(model => model.GrupoUsuarioId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Departamento </label>
                                <div class="col-sm-10">
                                    @Html.DropDownList("DepartamentoId", null, htmlAttributes: new { @class = "form-control", autocomplete = "off" })
                                    @Html.ValidationMessageFor(model => model.DepartamentoId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Posicion </label>
                                <div class="col-sm-10">
                                    <select id="PosicionId" name="PosicionId" class="form-control"></select>
                                    @Html.ValidationMessageFor(model => model.PosicionId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Correo </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Correo, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Correo, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Telefono </label>
                                <div class="col-sm-10">
                                    @Html.EditorFor(model => model.Telefono, new { htmlAttributes = new { @class = "form-control", autocomplete = "off" } })
                                    @Html.ValidationMessageFor(model => model.Telefono, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Genero </label>
                                <div class="col-sm-10">
                                    @Html.EnumDropDownListFor(model => model.Genero, htmlAttributes: new { @class = "form-control", autocomplete = "off" })
                                    @Html.ValidationMessageFor(model => model.Genero, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label"> Fecha Ingreso </label>
                                <div class="col-sm-4">
                                    <input type="date" id="FechaIngreso" name="FechaIngreso" class="form-control" value="@Model.FechaIngreso.ToString("yyyy-MM-dd")">
                                    @Html.ValidationMessageFor(model => model.FechaIngreso, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label">Aprobacion de RRHH</label>
                                <div class="col-sm-10 addtopspace">
                                    <div class="form-check form-switch">
                                        @Html.EditorFor(model => model.RRHHAutorizado, new { htmlAttributes = new { @class = "form-check-input" } })
                                        @Html.ValidationMessageFor(model => model.RRHHAutorizado, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label class="col-sm-2 col-form-label">Usuario Principal</label>
                                <div class="col-sm-10 addtopspace">
                                    <div class="form-check form-switch">
                                        @Html.EditorFor(model => model.IsCEO, new { htmlAttributes = new { @class = "form-check-input" } })
                                        @Html.ValidationMessageFor(model => model.IsCEO, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="text-center">
                                <input type="button" value="Volver Atras" class="btn btn-secondary" onclick="location.href='@Url.Action("Index", "Usuario") '" />
                                <input type="submit" value="Guardar" class="btn btn-primary" onclick="return confirm('Seguro que desea modificar el Usuario?')" />
                            </div>
                        }<!-- End Horizontal Form -->

                    </div>
                </div>
            </div>
        </div>
    </section>



    <script>
        $(function () {
            $("#PaisId").change(function () {
                var id = $(this).val();
                if (id !== '')
                    getCiudad(id, false);
            });
        });

        $(document).ready(function () {

            var id = $('#PaisId').val();
            if (id !== '')
                getCiudad(id, true);

            var DepartamentoId = $('#DepartamentoId').val();
            if (DepartamentoId !== '')
                getPosicion(DepartamentoId, true);
        });

        function getCiudad(id, isLoad) {
            $("#CiudadId").empty();
            $.get("/Usuario/Ciudad_Bind", { paisId: id }, function (data) {
                var lines = "<option>--- Seleccionar Ciudad ---</option>";
                $.each(data, function (i, valor) {
                    lines += "<option value=" + valor.Value + ">" + valor.Text + "</option>";
                });
                $("#CiudadId").html(lines);
                 if (isLoad === true)
                    $("#CiudadId").val(@Model.CiudadId);
            });
        }
    </script>

    <script>
        $(function () {
            $("#DepartamentoId").change(function () {
                var id = $(this).val();
                if (id !== '')
                    getPosicion(id, false);
            });
        });

        function getPosicion(id, isLoad) {
            $("#PosicionId").empty();
            $.get("/Usuario/Posicion_Bind", { DepartamentoId: id }, function (data) {
                var lines = "<option>--- Seleccionar Posicion ---</option>";
                $.each(data, function (i, valor) {
                    lines += "<option value=" + valor.Value + ">" + valor.Text + "</option>";
                });
                $("#PosicionId").html(lines);
                if (isLoad === true)
                    $("#PosicionId").val(@Model.PosicionId);
            });
        }
    </script>

